<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>SUV HUD Stable Metal</title>
<link rel="stylesheet" href="styles.css">
</head>

<body>

<div id="hud">

  <!-- RPM -->
  <div id="rpmCircle">
    <canvas id="rpmCanvas" width="140" height="140"></canvas>
  </div>

  <!-- SPEED BOX -->
  <div id="speedBox">
    <div id="gear">N</div>
    <div id="speed">0</div>
    <div id="unit">MPH</div>

    <div id="bars">
      <div class="barRow">
        <span class="icon">â›½</span>
        <div class="bar">
          <div id="fuelBar" class="fill fuel"></div>
        </div>
      </div>

      <div class="barRow">
        <span class="icon">ðŸ”§</span>
        <div class="bar">
          <div id="engineBar" class="fill engine"></div>
        </div>
      </div>
    </div>

    <div id="welcome">Welcome, Chief Darek</div>
  </div>

</div>

<script src="script.js"></script>

<script>
/* ================= RPM â€“ METAL TEXTURE ================= */
const ctx = rpmCanvas.getContext("2d");
let rpmSmooth = 0;

function drawRPM(v) {
  rpmSmooth += (v - rpmSmooth) * 0.12;
  ctx.clearRect(0,0,140,140);

  const cx = 70, cy = 70, r = 58;

  /* METAL BACKGROUND */
  const grad = ctx.createRadialGradient(cx, cy, 10, cx, cy, r);
  grad.addColorStop(0, "#2a2a2a");
  grad.addColorStop(0.6, "#0f0f0f");
  grad.addColorStop(1, "#000");
  ctx.fillStyle = grad;
  ctx.beginPath();
  ctx.arc(cx, cy, r, 0, Math.PI * 2);
  ctx.fill();

  /* METAL RING */
  ctx.strokeStyle = "#ff2a2a";
  ctx.lineWidth = 4;
  ctx.stroke();

  /* SCALE */
  for (let i = 0; i <= 8; i++) {
    const a = (-130 + i * 32.5) * Math.PI / 180;
    ctx.strokeStyle = i >= 7 ? "#ff4444" : "#cccccc";
    ctx.lineWidth = 2;

    ctx.beginPath();
    ctx.moveTo(
      cx + Math.cos(a) * (r - 6),
      cy + Math.sin(a) * (r - 6)
    );
    ctx.lineTo(
      cx + Math.cos(a) * r,
      cy + Math.sin(a) * r
    );
    ctx.stroke();

    if (i > 0) {
      ctx.fillStyle = "#e0e0e0";
      ctx.font = "10px Arial";
      ctx.textAlign = "center";
      ctx.textBaseline = "middle";
      ctx.fillText(
        i,
        cx + Math.cos(a) * (r - 16),
        cy + Math.sin(a) * (r - 16)
      );
    }
  }

  /* NEEDLE */
  const n = (-130 + rpmSmooth * 260) * Math.PI / 180;
  ctx.strokeStyle = "#ff2a2a";
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.moveTo(cx, cy);
  ctx.lineTo(
    cx + Math.cos(n) * (r - 12),
    cy + Math.sin(n) * (r - 12)
  );
  ctx.stroke();
}

/* ===== HOOKS (UNCHANGED / STABLE) ===== */
let speedMPH = 0;
let gearRaw = 0;

window.setRPM = v => drawRPM(v);

window.setSpeed = s => {
  speedMPH = Math.round(s * 2.23694);
  speed.innerText = speedMPH;
  updateGear();
};

window.setGear = g => {
  gearRaw = g;
  updateGear();
};

window.setFuel = f => fuelBar.style.width = (f * 100) + "%";
window.setHealth = h => engineBar.style.width = (h * 100) + "%";

function updateGear() {
  if (speedMPH === 0) gear.innerText = "N";
  else if (gearRaw === 0) gear.innerText = "R";
  else gear.innerText = gearRaw;
}

setSpeedMode(1);
</script>

</body>
</html>
